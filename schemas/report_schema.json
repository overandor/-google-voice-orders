{
  "$defs": {
    "AnalysisResult": {
      "properties": {
        "provider_used": {
          "description": "The service provider used for analysis (e.g., 'openai', 'huggingface', 'local').",
          "title": "Provider Used",
          "type": "string"
        },
        "model_used": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The specific model used for analysis.",
          "title": "Model Used"
        },
        "extractive_summary": {
          "description": "Summary generated by extracting key sentences.",
          "title": "Extractive Summary",
          "type": "string"
        },
        "abstractive_summary": {
          "description": "Summary generated by an LLM.",
          "title": "Abstractive Summary",
          "type": "string"
        },
        "influence_score": {
          "description": "Calculated score representing the potential influence of the content.",
          "title": "Influence Score",
          "type": "number"
        },
        "cost_usd": {
          "description": "Estimated cost of the analysis in USD.",
          "title": "Cost Usd",
          "type": "number"
        }
      },
      "required": [
        "provider_used",
        "extractive_summary",
        "abstractive_summary",
        "influence_score",
        "cost_usd"
      ],
      "title": "AnalysisResult",
      "type": "object"
    },
    "Provenance": {
      "properties": {
        "report_uuid": {
          "description": "Unique identifier for the report.",
          "title": "Report Uuid",
          "type": "string"
        },
        "file_sha256": {
          "description": "SHA-256 hash of the input file.",
          "title": "File Sha256",
          "type": "string"
        },
        "timestamp_utc": {
          "description": "Timestamp of the report generation in UTC.",
          "title": "Timestamp Utc",
          "type": "string"
        },
        "config_snapshot": {
          "additionalProperties": true,
          "description": "Snapshot of the configuration used for this report.",
          "title": "Config Snapshot",
          "type": "object"
        },
        "app_version": {
          "default": "0.1.0",
          "description": "Version of the application.",
          "title": "App Version",
          "type": "string"
        },
        "schema_version": {
          "default": "1.0.0",
          "description": "Version of the report schema.",
          "title": "Schema Version",
          "type": "string"
        }
      },
      "required": [
        "file_sha256",
        "config_snapshot"
      ],
      "title": "Provenance",
      "type": "object"
    },
    "RiskFlags": {
      "properties": {
        "pii_detected": {
          "description": "True if potential PII is detected.",
          "title": "Pii Detected",
          "type": "boolean"
        },
        "ip_risk_detected": {
          "description": "True if potential IP risks (e.g., quotes) are detected.",
          "title": "Ip Risk Detected",
          "type": "boolean"
        },
        "pii_summary": {
          "additionalProperties": {
            "type": "integer"
          },
          "description": "Summary of detected PII types and counts.",
          "title": "Pii Summary",
          "type": "object"
        },
        "ip_risk_summary": {
          "additionalProperties": {
            "type": "integer"
          },
          "description": "Summary of detected IP risk types and counts.",
          "title": "Ip Risk Summary",
          "type": "object"
        }
      },
      "required": [
        "pii_detected",
        "ip_risk_detected"
      ],
      "title": "RiskFlags",
      "type": "object"
    },
    "TextMetrics": {
      "properties": {
        "token_count": {
          "description": "Number of tokens in the text.",
          "title": "Token Count",
          "type": "integer"
        },
        "word_count": {
          "description": "Number of words in the text.",
          "title": "Word Count",
          "type": "integer"
        },
        "char_count": {
          "description": "Number of characters in the text.",
          "title": "Char Count",
          "type": "integer"
        },
        "semantic_density": {
          "description": "Ratio of non-stop words to total words.",
          "title": "Semantic Density",
          "type": "number"
        },
        "compression_ratio": {
          "description": "Ratio of compressed size to original size.",
          "title": "Compression Ratio",
          "type": "number"
        }
      },
      "required": [
        "token_count",
        "word_count",
        "char_count",
        "semantic_density",
        "compression_ratio"
      ],
      "title": "TextMetrics",
      "type": "object"
    }
  },
  "properties": {
    "file_path": {
      "description": "Path to the analyzed file.",
      "title": "File Path",
      "type": "string"
    },
    "metrics": {
      "$ref": "#/$defs/TextMetrics"
    },
    "risk": {
      "$ref": "#/$defs/RiskFlags"
    },
    "analysis": {
      "$ref": "#/$defs/AnalysisResult"
    },
    "provenance": {
      "$ref": "#/$defs/Provenance"
    }
  },
  "required": [
    "file_path",
    "metrics",
    "risk",
    "analysis",
    "provenance"
  ],
  "title": "Report",
  "type": "object"
}
